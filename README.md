# B站高质量视频爬虫

## 项目介绍

这是一个用于爬取B站各分类排行榜（每类最多只有100条数据）中高质量视频的爬虫工具。通过计算视频的点赞率（点赞数/播放数），筛选出点赞率大于0.1的高质量视频数据。

## 功能特点

- 🎯 **高质量筛选**：只保留点赞率>0.1的优质视频
- 📊 **多分类支持**：支持19个B站分类的数据爬取
- 🛡️ **反爬虫对抗**：合理设置请求头和延时，避免被封
- 📁 **数据组织**：自动分类保存到CSV文件
- 🔄 **增量更新**：支持清空旧数据重新爬取
- ⚙️ **配置灵活**：支持参数配置和批量处理

## 支持的分类

全站、番剧、国产动画、国创相关、纪录片、动画、音乐、舞蹈、游戏、知识、科技、运动、汽车、生活、美食、动物圈、鬼畜、时尚、娱乐、影视

## 项目结构

```
High_quality_Bilibili/
├── bilibili_crawler.py    # 🚀 主程序文件 - 核心爬虫逻辑
├── config.py              # ⚙️ 配置文件 - 爬虫参数设置
├── run.sh                 # 🔧 启动脚本 - 一键运行工具
├── README.md              # 📖 项目说明 - 使用文档
└── data/                  # 📁 数据文件夹 - 存储爬取结果
    ├── B站TOP-全站-高质量.csv
    ├── B站TOP-音乐-高质量.csv
    ├── B站TOP-舞蹈-高质量.csv
    ├── B站TOP-游戏-高质量.csv
    ├── B站TOP-美食-高质量.csv
    └── ...
```

### 文件说明

| 文件名 | 用途 | 说明 |
|--------|------|------|
| `bilibili_crawler.py` | 主程序 | 包含完整的爬虫逻辑、数据处理和文件保存功能 |
| `config.py` | 配置管理 | 定义爬虫参数、阈值设置、请求头等配置信息 |
| `run.sh` | 启动脚本 | 自动检查环境依赖并启动爬虫的便捷脚本 |
| `README.md` | 项目文档 | 详细的项目说明、使用指南和API文档 |
| `data/` | 数据目录 | 存储所有爬取到的高质量视频CSV文件 |

## 使用方法

### 环境要求

```bash
pip install pandas requests
```

### 快速开始

#### 方式1: 使用启动脚本（推荐）
```bash
cd High_quality_Bilibili
chmod +x run.sh
./run.sh
```

#### 方式2: 直接运行Python程序
```bash
cd High_quality_Bilibili
python bilibili_crawler.py
```

### 配置说明

所有爬虫参数都可以在 `config.py` 中修改：

```python
# 数据质量阈值
LIKE_RATE_THRESHOLD = 0.1        # 点赞率阈值，大于此值认为是高质量视频

# 爬取设置  
TARGET_COUNT_PER_CATEGORY = 10   # 每个分类爬取的目标视频数量
REQUEST_DELAY_MIN = 2            # 请求间隔最小秒数
REQUEST_DELAY_MAX = 4            # 请求间隔最大秒数
REQUEST_TIMEOUT = 10             # 请求超时时间（秒）

# 文件路径
DATA_DIR = "data"                # 数据保存目录
CSV_PREFIX = "B站TOP"            # CSV文件名前缀

# API设置
BASE_URL = "https://api.bilibili.com/x/web-interface/ranking/v2"
HEADERS = {...}                  # 完整的请求头配置
```

**配置优势**：
- 🎯 **灵活调节**：可根据需求调整点赞率阈值和爬取数量
- ⚡ **性能优化**：可调整请求延时避免被限制
- 📁 **路径管理**：统一管理文件存储路径和命名规则
- 🔧 **维护简单**：所有参数集中配置，便于维护

### 输出数据格式

CSV文件包含以下字段：
- 视频标题
- 视频地址
- 作者
- 播放数
- 弹幕数
- 投币数
- 点赞数
- 分享数
- 收藏数
- **点赞率**（核心指标）

## 核心算法

### 点赞率计算
```python
点赞率 = 点赞数 / 播放数
```

### 高质量标准
- 点赞率 > 0.1 认为是高质量视频
- 播放数为0的视频会被跳过（避免除零错误）

## 数据示例

| 视频标题 | 作者 | 播放数 | 点赞数 | 点赞率 |
|---------|------|--------|--------|--------|
| 【AI蚊子】恋爱循环 | 阮念゜ | 930575 | 162378 | 0.1745 |
| 拖孩一定觉得自己很酷吧 | 藤圆拖孩er | 212602 | 47225 | 0.2221 |

## 注意事项

1. **请求频率**：程序内置2-4秒随机延时，避免请求过于频繁
2. **网络环境**：需要稳定的网络连接访问B站API
3. **数据时效性**：排行榜数据会实时更新，建议定期重新爬取
4. **依赖安装**：首次运行前请确保安装了pandas和requests库
